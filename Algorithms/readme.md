 Общие алгоритмы, переделать под Си.
